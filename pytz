import xlrd
from datetime import datetime
import pytz

def convert_to_cst(input_date_str):
    # Define the input date format
    input_format = '%b %d %H:%M:%S %Y'

    # Parse the input date string
    input_date = datetime.strptime(input_date_str, input_format)

    # Convert to CST timezone
    cst_timezone = pytz.timezone('America/Chicago')
    cst_date = cst_timezone.localize(input_date)

    # Format the date in the desired output format
    output_format = '%Y-%m-%d %H:%M:%S'
    cst_date_str = cst_date.strftime(output_format)

    return cst_date_str

def process_excel_file(file_path):
    # Open the Excel file
    workbook = xlrd.open_workbook(file_path)
    sheet = workbook.sheet_by_index(0)  # Assuming data is in the first sheet

    # Assuming the date is in the first column of each row
    for row_num in range(sheet.nrows):
        date_str = sheet.cell_value(row_num, 0)
        
        # Skip header or empty rows
        if row_num == 0 or not date_str:
            continue

        # Convert date and print the result
        converted_date = convert_to_cst(date_str)
        print(f'Row {row_num + 1}: {converted_date}')

# Example usage
excel_file_path = 'path/to/your/excel/file.xlsx'
process_excel_file(excel_file_path)
