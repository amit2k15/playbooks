from pyzabbix import ZabbixAPI

# Zabbix server credentials
zabbix_server = 'https://your_zabbix_server'
username = 'your_username'
password = 'your_password'

# Connect to Zabbix API
zapi = ZabbixAPI(zabbix_server)
zapi.login(username, password)

# Specify the host group name
hostgroup_name = 'Your Host Group Name'

# Get host group ID
hostgroups = zapi.hostgroup.get(filter={'name': hostgroup_name})
if not hostgroups:
    print(f"Host group '{hostgroup_name}' not found.")
    zapi.logout()
    exit()

hostgroup_id = hostgroups[0]['groupid']

# Get hosts in the host group
hosts = zapi.host.get(groupids=hostgroup_id, output=['hostid', 'host', 'status'])

# Convert status to Enabled/Disabled
for host in hosts:
    host['status'] = 'Enabled' if host['status'] == '0' else 'Disabled'

# Generate CSV file
csv_filename = f"{hostgroup_name}_report.csv"
with open(csv_filename, 'w') as csv_file:
    csv_file.write("Host Name,Status\n")
    for host in hosts:
        csv_file.write(f"{host['host']},{host['status']}\n")

print(f"CSV report generated: {csv_filename}")

# Logout from Zabbix API
zapi.logout()
