import openpyxl
import subprocess

# Function to execute the shell command and get the output
def execute_command(hostname):
    command = f"zabbix_get -s {hostname} -k agent.hostname"
    result = subprocess.run(command, shell=True, capture_output=True, text=True)
    return result.stdout.strip()

# Load the Excel file
wb = openpyxl.load_workbook('input.xlsx')
sheet = wb.active

# Iterate through each row in the Excel sheet
for row in sheet.iter_rows(min_row=2, min_col=1, max_col=2, values_only=True):
    hostname = row[0]
    # Execute the command with the hostname from the Excel row
    output = execute_command(hostname)
    # Write the output to the next column
    sheet.cell(row=row[1], column=2, value=output)

# Save the modified Excel file
wb.save('output.xlsx')
