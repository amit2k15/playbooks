import subprocess
from openpyxl import load_workbook
from openpyxl.styles import Alignment

def execute_command(hostname):
    command = "zabbix_get -s {} -k agent.hostname".format(hostname)
    result = subprocess.check_output(command, shell=True)
    return result.strip()

def main():
    # Load Excel workbook
    wb = load_workbook('input.xlsx')
    ws = wb.active

    # Iterate through rows in Excel sheet
    for row in ws.iter_rows(min_row=2, max_col=2, values_only=True):
        hostname = row[0]
        output = execute_command(hostname)
        # Write output to Excel
        ws.cell(row=row[2], column=2, value=output)
        # Center-align the output cell
        ws.cell(row=row[2], column=2).alignment = Alignment(horizontal='center')

    # Save Excel workbook
    wb.save('output.xlsx')

if __name__ == "__main__":
    main()
