DELIMITER //

CREATE PROCEDURE Execute_Query(IN query_name VARCHAR(50))
BEGIN
    DECLARE final_query VARCHAR(1000);

    IF query_name = 'Zabbix' THEN
        SET final_query = 'SELECT 
                                Application,
                                SUM(CASE WHEN Severity = ''Informational'' THEN 1 ELSE 0 END) AS Informational,
                                SUM(CASE WHEN Severity = ''Warning'' THEN 1 ELSE 0 END) AS Warning,
                                SUM(CASE WHEN Severity = ''Minor'' THEN 1 ELSE 0 END) AS Minor,
                                SUM(CASE WHEN Severity = ''Major'' THEN 1 ELSE 0 END) AS Major,
                                SUM(CASE WHEN Severity = ''Critical'' THEN 1 ELSE 0 END) AS Critical,
                                SUM(CASE WHEN Severity = ''Notclassified'' THEN 1 ELSE 0 END) AS Notclassified
                            FROM 
                                your_table_name
                            GROUP BY 
                                Application;';
    ELSEIF query_name = 'Dynatrace' THEN
        SET final_query = 'SELECT Application, Count FROM DT;';
    ELSE
        SET final_query = 'SELECT ''Invalid query name'' AS Result;';
    END IF;

    PREPARE stmt FROM final_query;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
END//

DELIMITER ;
