import pandas as pd
from pyzabbix import ZabbixAPI

# Zabbix server credentials
zabbix_url = 'https://your_zabbix_server.com'
zabbix_user = 'your_username'
zabbix_password = 'your_password'

# Connect to Zabbix API
zapi = ZabbixAPI(zabbix_url)
zapi.login(zabbix_user, zabbix_password)

# Get hosts with items related to JVM monitoring
hosts = zapi.host.get(output='extend', selectGroups='extend', selectItems='extend')
jvm_hosts = []
for host in hosts:
    for item in host['items']:
        if 'jmx' in item['key_']:
            jvm_hosts.append({
                'Host Name': host['host'],
                'Host Group': host['groups'][0]['name'],
                'Status': host['status']
            })

# Create DataFrame and export to Excel
df = pd.DataFrame(jvm_hosts)
df.to_excel('jvm_monitoring_report.xlsx', index=False)

# Logout from Zabbix API
zapi.logout()
